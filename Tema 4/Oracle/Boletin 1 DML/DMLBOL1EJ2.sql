CREATE TABLE EQUIPO (
    NOMBRE_EQUIPO VARCHAR2 (50),
    CONSTRAINT PK_EQUIPO PRIMARY KEY (NOMBRE_EQUIPO)
);

CREATE TABLE CICLISTA (
    NOMBRE_CICLISTA VARCHAR2 (50),
    F_NACIMIENTO DATE,
    NACIONALIDAD VARCHAR2 (30),
    NOMBRE_EQUIPO VARCHAR2 (50),
    CONSTRAINT PK_CICLISTA PRIMARY KEY (NOMBRE_CICLISTA),
    CONSTRAINT FK_CICLISTA FOREIGN KEY (NOMBRE_EQUIPO) REFERENCES EQUIPO(NOMBRE_EQUIPO)
);

CREATE TABLE PRUEBA (
    NOMBRE_PRUEBA VARCHAR2 (50),
    ANO NUMBER (4),
    KM_TOTALES NUMBER (10),
    GANADOR VARCHAR2 (50),
    CONSTRAINT PK_PRUEBA PRIMARY KEY (NOMBRE_PRUEBA),
    CONSTRAINT FK_PRUEBA FOREIGN KEY (GANADOR) REFERENCES CICLISTA(NOMBRE_CICLISTA)
);

-- Parte 1
INSERT INTO EQUIPO VALUES ('Movistar');
INSERT INTO EQUIPO VALUES ('Jumbo');
INSERT INTO EQUIPO VALUES ('Bora');
INSERT INTO EQUIPO VALUES ('UAE Team');

INSERT INTO CICLISTA VALUES ('Alejandro Valverde', DATE '1980-04-25', 'Español','Movistar');
INSERT INTO CICLISTA VALUES ('Alejandra Valverde', DATE '1980-04-25', 'Español','Movistar');
INSERT INTO CICLISTA VALUES ('Mathias Norsgaard', DATE '1997-05-01', 'Danés','Movistar');
INSERT INTO CICLISTA VALUES ('Primox Roglic', DATE '1997-01-01', 'Esloveno','Jumbo');
INSERT INTO CICLISTA VALUES ('R. Gesink', DATE '2003-05-01', 'Holandés','Jumbo');
INSERT INTO CICLISTA VALUES ('S. Bennett', DATE '2000-08-03', 'Irlandés','Bora');
INSERT INTO CICLISTA VALUES ('M. Soler', DATE '2003-11-09', 'Español','UAE Team');
INSERT INTO CICLISTA VALUES ('Joel Ruiz', DATE '2006-11-13', 'Español','Movistar');

INSERT INTO PRUEBA VALUES ('E1_2022', 2022, 23, 'R. Gesink');
INSERT INTO PRUEBA VALUES ('E2_2022', 2022, 175, 'Primox Roglic');
INSERT INTO PRUEBA VALUES ('E3_2022', 2022, 193, 'S. Bennett');
INSERT INTO PRUEBA VALUES ('E1_2021', 2021, 154, 'S. Bennett');
INSERT INTO PRUEBA VALUES ('E2_2021', 2021, 189, 'M. Soler');
INSERT INTO PRUEBA VALUES ('E1_2020', 2020, 40, 'Alejandro Valverde');


-- Parte 2
UPDATE PRUEBA
SET NOMBRE_PRUEBA = 'Contrarreloj_' || ANO
WHERE KM_TOTALES < 100;


-- Parte 3
CREATE TABLE CICLISTAS_ESPAÑOLES (
    NOMBRE_CICLISTA VARCHAR2(50),
    NOMBRE_EQUIPO   VARCHAR2(50)
);

INSERT INTO CICLISTAS_ESPAÑOLES (NOMBRE_CICLISTA, NOMBRE_EQUIPO)
SELECT NOMBRE_CICLISTA, NOMBRE_EQUIPO
FROM CICLISTA
WHERE NACIONALIDAD = 'Español';

